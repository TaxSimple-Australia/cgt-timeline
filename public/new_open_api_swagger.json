{"openapi":"3.1.0","info":{"title":"CGT Brain API","description":"\n## Australian Capital Gains Tax Analysis System\n\nThis API provides RAG-powered CGT calculations with human-in-the-loop feedback.\n\n### Key Features\n- **CGT Analysis**: Submit property timelines and get detailed tax calculations\n- **Multiple LLMs**: Support for Claude, GPT-4, DeepSeek, Gemini, and Olmo\n- **Gap Detection**: Automatic detection of timeline gaps requiring clarification\n- **Follow-up Chat**: Ask follow-up questions about your analysis\n- **Tax Agent Review**: Human annotation system for quality assurance\n- **Auto-Learning**: Few-shot injection from human corrections\n\n### Workflow\n1. Submit property data to `/calculate-cgt/`\n2. Answer any clarification questions about timeline gaps\n3. Review the analysis and ask follow-up questions via `/follow-up/`\n4. Tax agents review outputs in the annotation queue\n5. Corrections automatically improve future responses\n    ","version":"2.0.0"},"paths":{"/llm-providers/":{"get":{"tags":["Utilities"],"summary":"List Llm Providers","description":"List available LLM providers and the default selection.","operationId":"list_llm_providers_llm_providers__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/query/":{"get":{"tags":["CGT Analysis"],"summary":"Query Rag System","description":"Simple query endpoint for basic CGT questions (no property data).","operationId":"query_rag_system_query__get","parameters":[{"name":"query","in":"query","required":true,"schema":{"type":"string","title":"Query"}},{"name":"llm_provider","in":"query","required":false,"schema":{"type":"string","default":"deepseek","title":"Llm Provider"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/calculate-cgt/":{"post":{"tags":["CGT Analysis"],"summary":"Calculate Cgt","description":"Calculate CGT for properties with markdown output.\n\nDetects timeline gaps and returns clarification questions if needed.\nRe-submit with `verification_responses` to resolve gaps.","operationId":"calculate_cgt_calculate_cgt__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CGTRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CGTResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/follow-up/":{"post":{"tags":["Follow-up Chat"],"summary":"Follow Up Question","description":"Ask follow-up questions about your CGT analysis.\n\nSupports: clarifications, \"what if\" scenarios, data updates, and recalculations.","operationId":"follow_up_question_follow_up__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FollowUpRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FollowUpResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/training-data/stats/":{"get":{"tags":["Training Data"],"summary":"Get Training Stats","description":"Get statistics about stored sessions and messages for fine-tuning.","operationId":"get_training_stats_training_data_stats__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/training-data/export/":{"get":{"tags":["Training Data"],"summary":"Export Training Data","description":"Export sessions as instruction/input/output pairs for fine-tuning.\n\nFormat: `json` (default) or `jsonl`","operationId":"export_training_data_training_data_export__get","parameters":[{"name":"format","in":"query","required":false,"schema":{"type":"string","default":"json","title":"Format"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/suggest-questions/":{"post":{"tags":["Utilities"],"summary":"Suggest Questions","description":"Generate contextual CGT question suggestions based on property data.\n\nRun before analysis to help users formulate good queries.","operationId":"suggest_questions_suggest_questions__post","parameters":[{"name":"num_questions","in":"query","required":false,"schema":{"type":"integer","default":5,"title":"Num Questions"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CGTRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuggestQuestionsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/calculate-cgt-json/":{"post":{"tags":["CGT Analysis"],"summary":"Calculate Cgt Json","description":"Calculate CGT with structured JSON output (typed fields for frontend).","operationId":"calculate_cgt_json_calculate_cgt_json__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CGTRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CGTJSONResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/calculate-cgt-report/":{"post":{"tags":["CGT Analysis"],"summary":"Calculate Cgt Report","description":"Calculate CGT with structured report format (sections, timeline, rules).","operationId":"calculate_cgt_report_calculate_cgt_report__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CGTRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CGTReportResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/annotation/queue/":{"get":{"tags":["Tax Agent Review"],"summary":"Get Annotation Queue","description":"Get items in the review queue.\n\nFilter by status: `pending`, `annotated`, or `skipped`","operationId":"get_annotation_queue_annotation_queue__get","parameters":[{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/annotation/item/{item_id}":{"get":{"tags":["Tax Agent Review"],"summary":"Get Annotation Item","description":"Get full details of an item for review (query, property data, docs, answer).","operationId":"get_annotation_item_annotation_item__item_id__get","parameters":[{"name":"item_id","in":"path","required":true,"schema":{"type":"string","title":"Item Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/annotation/submit/":{"post":{"tags":["Tax Agent Review"],"summary":"Submit Annotation","description":"Submit a review with correctness rating and optional correction.","operationId":"submit_annotation_annotation_submit__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnnotationSubmission"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/annotation/update/":{"put":{"tags":["Tax Agent Review"],"summary":"Update Annotation","description":"Update/edit an existing review.","operationId":"update_annotation_annotation_update__put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AnnotationSubmission"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/annotation/skip/{item_id}":{"post":{"tags":["Tax Agent Review"],"summary":"Skip Annotation Item","description":"Skip an item in the review queue.","operationId":"skip_annotation_item_annotation_skip__item_id__post","parameters":[{"name":"item_id","in":"path","required":true,"schema":{"type":"string","title":"Item Id"}},{"name":"reason","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reason"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/annotation/add/":{"post":{"tags":["Tax Agent Review"],"summary":"Add To Annotation Queue","description":"Manually add a RAG output to the review queue.\nReturns duplicate info if this scenario was submitted before.","operationId":"add_to_annotation_queue_annotation_add__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddToQueueRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/annotation/stats/":{"get":{"tags":["Tax Agent Review"],"summary":"Get Annotation Stats","description":"Get review queue statistics (pending, annotated, skipped counts).","operationId":"get_annotation_stats_annotation_stats__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/annotation/ground-truth/":{"get":{"tags":["Tax Agent Review"],"summary":"Get Ground Truth","description":"Get annotated items with human corrections (for evaluation/fine-tuning).","operationId":"get_ground_truth_annotation_ground_truth__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/annotation/export/":{"post":{"tags":["Tax Agent Review"],"summary":"Export Annotations","description":"Export all annotated data to JSON file.","operationId":"export_annotations_annotation_export__post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/accuracy/dashboard/":{"get":{"tags":["Accuracy Dashboard"],"summary":"Get Accuracy Dashboard","description":"Get complete accuracy analytics: overall rate, by scenario, by LLM, failure patterns.","operationId":"get_accuracy_dashboard_accuracy_dashboard__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/accuracy/by-scenario/":{"get":{"tags":["Accuracy Dashboard"],"summary":"Get Accuracy By Scenario","description":"Accuracy metrics by CGT scenario (main_residence, six_year_absence, etc.).","operationId":"get_accuracy_by_scenario_accuracy_by_scenario__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/accuracy/by-llm/":{"get":{"tags":["Accuracy Dashboard"],"summary":"Get Accuracy By Llm","description":"Accuracy metrics by LLM provider (Claude, GPT-4, etc.).","operationId":"get_accuracy_by_llm_accuracy_by_llm__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/accuracy/failure-patterns/":{"get":{"tags":["Accuracy Dashboard"],"summary":"Get Failure Patterns","description":"Common failure patterns with priority and improvement recommendations.","operationId":"get_failure_patterns_accuracy_failure_patterns__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/accuracy/recent-reviews/":{"get":{"tags":["Accuracy Dashboard"],"summary":"Get Recent Reviews","description":"Get recent reviews with full details (query, answer, correction, notes).","operationId":"get_recent_reviews_accuracy_recent_reviews__get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/accuracy/expert-feedback/":{"get":{"tags":["Accuracy Dashboard"],"summary":"Get Expert Feedback","description":"Aggregated expert feedback: common themes, critical notes, suggestions.","operationId":"get_expert_feedback_accuracy_expert_feedback__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/accuracy/system-health/":{"get":{"tags":["Accuracy Dashboard"],"summary":"Get System Health","description":"System health diagnostics: index status, data quality, actionable recommendations.","operationId":"get_system_health_accuracy_system_health__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/accuracy/retrieval-analysis/":{"get":{"tags":["Accuracy Dashboard"],"summary":"Get Retrieval Analysis","description":"Detailed retrieval quality analysis: which docs are useful, which need improvement.","operationId":"get_retrieval_analysis_accuracy_retrieval_analysis__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/accuracy/training-readiness/":{"get":{"tags":["Accuracy Dashboard"],"summary":"Get Training Readiness","description":"Analyze training data readiness for DPO/SFT fine-tuning.\n\nReturns metrics to help engineers decide when they have enough quality data.","operationId":"get_training_readiness_accuracy_training_readiness__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/accuracy/category-balance/":{"get":{"tags":["Accuracy Dashboard"],"summary":"Get Category Balance","description":"Detailed category balance analysis for training data diversity.\n\nShows scenario distribution and identifies underrepresented categories.","operationId":"get_category_balance_accuracy_category_balance__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/accuracy/export-dpo/":{"get":{"tags":["Accuracy Dashboard"],"summary":"Export Dpo Data","description":"Export reviews in DPO training format (prompt/chosen/rejected triplets).\n\nArgs:\n    include_partial: Include partially correct items (default True)\n    format: Output format - 'json' or 'jsonl'","operationId":"export_dpo_data_accuracy_export_dpo__get","parameters":[{"name":"include_partial","in":"query","required":false,"schema":{"type":"boolean","default":true,"title":"Include Partial"}},{"name":"format","in":"query","required":false,"schema":{"type":"string","default":"json","title":"Format"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/accuracy/export-sft/":{"get":{"tags":["Accuracy Dashboard"],"summary":"Export Sft Data","description":"Export reviews in SFT (Supervised Fine-Tuning) format.\n\nFormat: instruction/input/output triplets.","operationId":"export_sft_data_accuracy_export_sft__get","parameters":[{"name":"format","in":"query","required":false,"schema":{"type":"string","default":"json","title":"Format"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/fewshot/stats/":{"get":{"tags":["Few-Shot Learning"],"summary":"Get Fewshot Stats","description":"Get statistics about indexed examples for prompt injection.","operationId":"get_fewshot_stats_fewshot_stats__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/fewshot/rebuild/":{"post":{"tags":["Few-Shot Learning"],"summary":"Rebuild Fewshot Index","description":"Rebuild the examples index from current annotations.","operationId":"rebuild_fewshot_index_fewshot_rebuild__post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/fewshot/preview/":{"post":{"tags":["Few-Shot Learning"],"summary":"Preview Fewshot Examples","description":"Preview which examples would be injected for a query (for debugging).","operationId":"preview_fewshot_examples_fewshot_preview__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FewShotPreviewRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AddToQueueRequest":{"properties":{"query":{"type":"string","title":"Query"},"properties_data":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Properties Data"},"generated_answer":{"type":"string","title":"Generated Answer"},"retrieved_docs":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Retrieved Docs"},"sources":{"additionalProperties":true,"type":"object","title":"Sources"},"llm_used":{"type":"string","title":"Llm Used"}},"type":"object","required":["query","properties_data","generated_answer","retrieved_docs","sources","llm_used"],"title":"AddToQueueRequest","description":"Request model for adding an item to annotation queue."},"AdditionalInfo":{"properties":{},"additionalProperties":true,"type":"object","title":"AdditionalInfo"},"AnnotationSubmission":{"properties":{"item_id":{"type":"string","title":"Item Id"},"correctness":{"type":"string","title":"Correctness"},"correct_answer":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Correct Answer"},"doc_annotations":{"anyOf":[{"items":{"additionalProperties":true,"type":"object"},"type":"array"},{"type":"null"}],"title":"Doc Annotations"},"faithfulness_notes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Faithfulness Notes"},"general_notes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"General Notes"},"annotator":{"type":"string","title":"Annotator","default":"anonymous"}},"type":"object","required":["item_id","correctness"],"title":"AnnotationSubmission","description":"Request model for submitting an annotation."},"ApplicableRule":{"properties":{"section":{"type":"string","title":"Section"},"name":{"type":"string","title":"Name"},"description":{"type":"string","title":"Description"},"applies":{"type":"boolean","title":"Applies","default":true}},"type":"object","required":["section","name","description"],"title":"ApplicableRule","description":"An applicable ITAA97 tax rule."},"CGTCalculationSummary-Input":{"properties":{"sale_price":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Sale Price"},"total_cost_base":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Total Cost Base"},"gross_capital_gain":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Gross Capital Gain"},"main_residence_exemption_percentage":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Main Residence Exemption Percentage","default":"0"},"main_residence_exemption_amount":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Main Residence Exemption Amount","default":"0"},"taxable_capital_gain":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Taxable Capital Gain"},"cgt_discount_applicable":{"type":"boolean","title":"Cgt Discount Applicable","default":false},"cgt_discount_percentage":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Cgt Discount Percentage","default":"0"},"cgt_discount_amount":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Cgt Discount Amount","default":"0"},"net_capital_gain":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Net Capital Gain"},"tax_on_cgt":{"anyOf":[{"$ref":"#/components/schemas/TaxOnCGTResponse-Input"},{"type":"null"}]}},"type":"object","required":["sale_price","total_cost_base","gross_capital_gain","taxable_capital_gain","net_capital_gain"],"title":"CGTCalculationSummary","description":"Summary table of CGT calculation."},"CGTCalculationSummary-Output":{"properties":{"sale_price":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Sale Price"},"total_cost_base":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Total Cost Base"},"gross_capital_gain":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Gross Capital Gain"},"main_residence_exemption_percentage":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Main Residence Exemption Percentage","default":"0"},"main_residence_exemption_amount":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Main Residence Exemption Amount","default":"0"},"taxable_capital_gain":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Taxable Capital Gain"},"cgt_discount_applicable":{"type":"boolean","title":"Cgt Discount Applicable","default":false},"cgt_discount_percentage":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Cgt Discount Percentage","default":"0"},"cgt_discount_amount":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Cgt Discount Amount","default":"0"},"net_capital_gain":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Net Capital Gain"},"tax_on_cgt":{"anyOf":[{"$ref":"#/components/schemas/TaxOnCGTResponse-Output"},{"type":"null"}]}},"type":"object","required":["sale_price","total_cost_base","gross_capital_gain","taxable_capital_gain","net_capital_gain"],"title":"CGTCalculationSummary","description":"Summary table of CGT calculation."},"CGTJSONResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"query":{"type":"string","title":"Query"},"needs_clarification":{"type":"boolean","title":"Needs Clarification","default":false},"clarification_questions":{"anyOf":[{"items":{"$ref":"#/components/schemas/ClarificationQuestion"},"type":"array"},{"type":"null"}],"title":"Clarification Questions"},"data":{"anyOf":[{"$ref":"#/components/schemas/PortfolioJSONAnalysis-Output"},{"type":"null"}]},"sources":{"anyOf":[{"$ref":"#/components/schemas/Sources"},{"type":"null"}]},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"},"properties_analyzed":{"type":"integer","title":"Properties Analyzed"},"llm_used":{"type":"string","title":"Llm Used"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id"}},"type":"object","required":["success","query","properties_analyzed","llm_used"],"title":"CGTJSONResponse","description":"API response model for JSON CGT analysis endpoint."},"CGTReportResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"query":{"type":"string","title":"Query"},"report":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Report"},"sources":{"anyOf":[{"$ref":"#/components/schemas/Sources"},{"type":"null"}]},"properties_analyzed":{"type":"integer","title":"Properties Analyzed"},"llm_used":{"type":"string","title":"Llm Used"},"needs_clarification":{"type":"boolean","title":"Needs Clarification","default":false},"clarification_questions":{"anyOf":[{"items":{"$ref":"#/components/schemas/ClarificationQuestion"},"type":"array"},{"type":"null"}],"title":"Clarification Questions"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success","query","properties_analyzed","llm_used"],"title":"CGTReportResponse","description":"Response model for CGT Brain Report endpoint - returns structured JSON."},"CGTRequest":{"properties":{"properties":{"items":{"$ref":"#/components/schemas/Property"},"type":"array","title":"Properties"},"user_query":{"type":"string","title":"User Query"},"additional_info":{"anyOf":[{"$ref":"#/components/schemas/AdditionalInfo"},{"type":"null"}]},"llm_provider":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Llm Provider","default":"deepseek"},"verification_responses":{"anyOf":[{"items":{"$ref":"#/components/schemas/VerificationResponse"},"type":"array"},{"type":"null"}],"title":"Verification Responses"}},"additionalProperties":true,"type":"object","required":["properties","user_query"],"title":"CGTRequest","examples":[{"additional_info":{"australian_resident":true,"land_size_hectares":0.9,"main_residence_choices":{"brisbane_home":"Did NOT claim main residence exemption","melbourne_home":"Did NOT claim main residence exemption","sydney_home":"Claimed as main residence (treating as main residence during absences)"},"tax_year":"2024-2025"},"llm_provider":"claude","properties":[{"address":"Sydney Home (address not specified)","property_history":[{"date":"1994-07-01","event":"purchase","price":300000,"purchase_legal_fees":2500,"stamp_duty":12000},{"date":"1994-07-01","event":"move_in"},{"date":"1996-01-01","event":"move_out"},{"date":"1996-01-01","event":"rent_start"},{"date":"2000-12-31","event":"rent_end"},{"date":"2001-03-01","event":"rent_start"},{"date":"2003-02-28","event":"rent_end"},{"date":"2004-12-31","event":"move_in"},{"agent_fees":13750,"contract_date":"2025-02-28","date":"2025-02-28","event":"sale","legal_fees":3000,"price":550000},{"date":"2025-02-28","event":"move_out"}],"notes":"sold - Main residence 1994-1996, rented 1996-2001, vacant 2001, rented 2001-2003, vacant 2003-2004, main residence 2005-2025"},{"address":"Brisbane Home (address not specified)","property_history":[{"date":"1996-01-01","event":"purchase","price":250000,"purchase_legal_fees":2000,"stamp_duty":10000},{"date":"1996-01-01","event":"move_in"},{"agent_fees":8000,"contract_date":"2000-12-31","date":"2000-12-31","event":"sale","legal_fees":2500,"price":320000},{"date":"2000-12-31","event":"move_out"}],"notes":"sold - Ian chose NOT to claim main residence exemption for this property"},{"address":"Melbourne Home (address not specified)","property_history":[{"date":"2001-01-01","event":"purchase","price":280000,"purchase_legal_fees":2200,"stamp_duty":11200},{"date":"2001-01-01","event":"move_in"},{"agent_fees":8750,"contract_date":"2003-12-31","date":"2003-12-31","event":"sale","legal_fees":2500,"price":350000},{"date":"2003-12-31","event":"move_out"}],"notes":"sold - Ian chose NOT to claim main residence exemption for this property"}],"user_query":"Calculate CGT for my Sydney home which I owned for 30+ years with multiple rental periods totaling more than 6 years. I also owned and sold Brisbane and Melbourne homes during this period but did not claim main residence exemption for those properties.","verification_responses":[{"issue_period":{"end_date":"2004-12-31","start_date":"2003-02-28"},"property_address":"Sydney Home (address not specified)","resolution_question":"After the rental ended on 2003-02-28, what was the status of Sydney Home (address not specified) until 2004-12-31 (672 days)? Please explain what happened during this vacancy period.","resolved_at":"2025-12-03T17:25:00.000Z","user_response":"Property was vacant while looking for tenants"}]}]},"CGTResponse":{"properties":{"query":{"type":"string","title":"Query"},"answer":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Answer"},"sources":{"anyOf":[{"$ref":"#/components/schemas/Sources"},{"type":"null"}]},"properties_analyzed":{"type":"integer","title":"Properties Analyzed"},"llm_used":{"type":"string","title":"Llm Used"},"needs_clarification":{"type":"boolean","title":"Needs Clarification","default":false},"clarification_questions":{"anyOf":[{"items":{"$ref":"#/components/schemas/ClarificationQuestion"},"type":"array"},{"type":"null"}],"title":"Clarification Questions"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id"},"trace_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Trace Id"}},"additionalProperties":true,"type":"object","required":["query","properties_analyzed","llm_used"],"title":"CGTResponse"},"CalculationStep":{"properties":{"step_number":{"type":"integer","title":"Step Number"},"title":{"type":"string","title":"Title"},"description":{"type":"string","title":"Description"},"calculation":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Calculation"},"result":{"type":"string","title":"Result"}},"type":"object","required":["step_number","title","description","result"],"title":"CalculationStep","description":"A single step in the CGT calculation."},"ClarificationQuestion":{"properties":{"gap_id":{"type":"string","title":"Gap Id"},"property_address":{"type":"string","title":"Property Address"},"period":{"additionalProperties":true,"type":"object","title":"Period"},"question":{"type":"string","title":"Question"},"options":{"items":{"type":"string"},"type":"array","title":"Options"},"severity":{"type":"string","title":"Severity"}},"type":"object","required":["gap_id","property_address","period","question","options","severity"],"title":"ClarificationQuestion","description":"A clarification question for a timeline gap."},"CostBaseItem-Input":{"properties":{"description":{"type":"string","title":"Description"},"amount":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Amount"}},"type":"object","required":["description","amount"],"title":"CostBaseItem","description":"A single cost base element."},"CostBaseItem-Output":{"properties":{"description":{"type":"string","title":"Description"},"amount":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Amount"}},"type":"object","required":["description","amount"],"title":"CostBaseItem","description":"A single cost base element."},"FewShotPreviewRequest":{"properties":{"query":{"type":"string","title":"Query"},"properties":{"anyOf":[{"items":{"additionalProperties":true,"type":"object"},"type":"array"},{"type":"null"}],"title":"Properties"},"k":{"type":"integer","title":"K","default":2}},"type":"object","required":["query"],"title":"FewShotPreviewRequest","description":"Request model for previewing few-shot examples."},"FollowUpRequest":{"properties":{"session_id":{"type":"string","title":"Session Id"},"question":{"type":"string","title":"Question"},"llm_provider":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Llm Provider","default":"deepseek"}},"type":"object","required":["session_id","question"],"title":"FollowUpRequest","description":"Request model for follow-up questions."},"FollowUpResponse":{"properties":{"query":{"type":"string","title":"Query"},"answer":{"type":"string","title":"Answer"},"sources":{"anyOf":[{"$ref":"#/components/schemas/Sources"},{"type":"null"}]},"session_id":{"type":"string","title":"Session Id"},"llm_used":{"type":"string","title":"Llm Used"},"message_count":{"type":"integer","title":"Message Count"},"question_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Question Type"},"retrieval_used":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Retrieval Used"},"recalculation_performed":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Recalculation Performed"},"data_updated":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Data Updated"},"updated_analysis":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Updated Analysis"},"is_hypothetical":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Hypothetical"},"wants_comparison":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Wants Comparison"},"comparison_summary":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Comparison Summary"},"awaiting_confirmation":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Awaiting Confirmation"}},"type":"object","required":["query","answer","session_id","llm_used","message_count"],"title":"FollowUpResponse","description":"Response model for follow-up questions."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"IssuePeriod":{"properties":{"start_date":{"type":"string","title":"Start Date"},"end_date":{"type":"string","title":"End Date"}},"additionalProperties":true,"type":"object","required":["start_date","end_date"],"title":"IssuePeriod"},"OwnershipPeriod-Input":{"properties":{"period_type":{"type":"string","title":"Period Type"},"days":{"type":"integer","title":"Days"},"years":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Years"},"percentage":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Percentage"},"note":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Note"}},"type":"object","required":["period_type","days","years","percentage"],"title":"OwnershipPeriod","description":"Breakdown of ownership period."},"OwnershipPeriod-Output":{"properties":{"period_type":{"type":"string","title":"Period Type"},"days":{"type":"integer","title":"Days"},"years":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Years"},"percentage":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Percentage"},"note":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Note"}},"type":"object","required":["period_type","days","years","percentage"],"title":"OwnershipPeriod","description":"Breakdown of ownership period."},"PortfolioJSONAnalysis-Input":{"properties":{"analysis_date":{"type":"string","title":"Analysis Date"},"total_properties":{"type":"integer","title":"Total Properties"},"description":{"type":"string","title":"Description"},"timeline_understanding":{"type":"string","title":"Timeline Understanding"},"properties":{"items":{"$ref":"#/components/schemas/PropertyAnalysis-Input"},"type":"array","title":"Properties","default":[]},"total_net_capital_gain":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Total Net Capital Gain"},"total_gross_gains":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Total Gross Gains"},"properties_with_cgt":{"type":"integer","title":"Properties With Cgt"},"properties_fully_exempt":{"type":"integer","title":"Properties Fully Exempt"},"general_notes":{"items":{"type":"string"},"type":"array","title":"General Notes","default":[]}},"type":"object","required":["analysis_date","total_properties","description","timeline_understanding","total_net_capital_gain","total_gross_gains","properties_with_cgt","properties_fully_exempt"],"title":"PortfolioJSONAnalysis","description":"Complete structured JSON response for portfolio CGT analysis."},"PortfolioJSONAnalysis-Output":{"properties":{"analysis_date":{"type":"string","title":"Analysis Date"},"total_properties":{"type":"integer","title":"Total Properties"},"description":{"type":"string","title":"Description"},"timeline_understanding":{"type":"string","title":"Timeline Understanding"},"properties":{"items":{"$ref":"#/components/schemas/PropertyAnalysis-Output"},"type":"array","title":"Properties","default":[]},"total_net_capital_gain":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Total Net Capital Gain"},"total_gross_gains":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Total Gross Gains"},"properties_with_cgt":{"type":"integer","title":"Properties With Cgt"},"properties_fully_exempt":{"type":"integer","title":"Properties Fully Exempt"},"general_notes":{"items":{"type":"string"},"type":"array","title":"General Notes","default":[]}},"type":"object","required":["analysis_date","total_properties","description","timeline_understanding","total_net_capital_gain","total_gross_gains","properties_with_cgt","properties_fully_exempt"],"title":"PortfolioJSONAnalysis","description":"Complete structured JSON response for portfolio CGT analysis."},"Property":{"properties":{"address":{"type":"string","title":"Address"},"property_history":{"items":{"$ref":"#/components/schemas/PropertyEvent"},"type":"array","title":"Property History"},"notes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Notes"}},"additionalProperties":true,"type":"object","required":["address","property_history"],"title":"Property"},"PropertyAnalysis-Input":{"properties":{"property_address":{"type":"string","title":"Property Address"},"purchase_date":{"type":"string","title":"Purchase Date"},"purchase_price":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Purchase Price"},"sale_date":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sale Date"},"sale_price":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"Sale Price"},"total_ownership_days":{"type":"integer","title":"Total Ownership Days"},"total_ownership_years":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Total Ownership Years"},"main_residence_days":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Main Residence Days"},"main_residence_percentage":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"Main Residence Percentage"},"rental_period_days":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Rental Period Days"},"rental_period_years":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"Rental Period Years"},"market_value_at_first_rental":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"Market Value At First Rental"},"first_use_rule_applied":{"type":"boolean","title":"First Use Rule Applied","default":false},"deemed_acquisition_date":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Deemed Acquisition Date"},"timeline":{"items":{"$ref":"#/components/schemas/TimelineEvent"},"type":"array","title":"Timeline","default":[]},"cost_base_items":{"items":{"$ref":"#/components/schemas/CostBaseItem-Input"},"type":"array","title":"Cost Base Items","default":[]},"total_cost_base":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Total Cost Base"},"ownership_periods":{"items":{"$ref":"#/components/schemas/OwnershipPeriod-Input"},"type":"array","title":"Ownership Periods","default":[]},"calculation_steps":{"items":{"$ref":"#/components/schemas/CalculationStep"},"type":"array","title":"Calculation Steps","default":[]},"calculation_summary":{"anyOf":[{"$ref":"#/components/schemas/CGTCalculationSummary-Input"},{"type":"null"}]},"result":{"type":"string","title":"Result"},"cgt_payable":{"type":"boolean","title":"Cgt Payable","default":false},"applicable_rules":{"items":{"$ref":"#/components/schemas/ApplicableRule"},"type":"array","title":"Applicable Rules","default":[]},"important_notes":{"items":{"type":"string"},"type":"array","title":"Important Notes","default":[]}},"type":"object","required":["property_address","purchase_date","purchase_price","total_ownership_days","total_ownership_years","total_cost_base","result"],"title":"PropertyAnalysis","description":"Complete CGT analysis for a single property."},"PropertyAnalysis-Output":{"properties":{"property_address":{"type":"string","title":"Property Address"},"purchase_date":{"type":"string","title":"Purchase Date"},"purchase_price":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Purchase Price"},"sale_date":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sale Date"},"sale_price":{"anyOf":[{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"Sale Price"},"total_ownership_days":{"type":"integer","title":"Total Ownership Days"},"total_ownership_years":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Total Ownership Years"},"main_residence_days":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Main Residence Days"},"main_residence_percentage":{"anyOf":[{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"Main Residence Percentage"},"rental_period_days":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Rental Period Days"},"rental_period_years":{"anyOf":[{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"Rental Period Years"},"market_value_at_first_rental":{"anyOf":[{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"Market Value At First Rental"},"first_use_rule_applied":{"type":"boolean","title":"First Use Rule Applied","default":false},"deemed_acquisition_date":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Deemed Acquisition Date"},"timeline":{"items":{"$ref":"#/components/schemas/TimelineEvent"},"type":"array","title":"Timeline","default":[]},"cost_base_items":{"items":{"$ref":"#/components/schemas/CostBaseItem-Output"},"type":"array","title":"Cost Base Items","default":[]},"total_cost_base":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Total Cost Base"},"ownership_periods":{"items":{"$ref":"#/components/schemas/OwnershipPeriod-Output"},"type":"array","title":"Ownership Periods","default":[]},"calculation_steps":{"items":{"$ref":"#/components/schemas/CalculationStep"},"type":"array","title":"Calculation Steps","default":[]},"calculation_summary":{"anyOf":[{"$ref":"#/components/schemas/CGTCalculationSummary-Output"},{"type":"null"}]},"result":{"type":"string","title":"Result"},"cgt_payable":{"type":"boolean","title":"Cgt Payable","default":false},"applicable_rules":{"items":{"$ref":"#/components/schemas/ApplicableRule"},"type":"array","title":"Applicable Rules","default":[]},"important_notes":{"items":{"type":"string"},"type":"array","title":"Important Notes","default":[]}},"type":"object","required":["property_address","purchase_date","purchase_price","total_ownership_days","total_ownership_years","total_cost_base","result"],"title":"PropertyAnalysis","description":"Complete CGT analysis for a single property."},"PropertyEvent":{"properties":{"date":{"type":"string","title":"Date"},"event":{"type":"string","title":"Event"}},"additionalProperties":true,"type":"object","required":["date","event"],"title":"PropertyEvent"},"SourceReference":{"properties":{"page":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Page"},"title":{"type":"string","title":"Title"},"source_document":{"type":"string","title":"Source Document"},"url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Url"}},"type":"object","required":["title","source_document"],"title":"SourceReference"},"Sources":{"properties":{"references":{"items":{"$ref":"#/components/schemas/SourceReference"},"type":"array","title":"References"},"rules_summary":{"type":"string","title":"Rules Summary"}},"type":"object","required":["references","rules_summary"],"title":"Sources"},"SuggestQuestionsResponse":{"properties":{"suggested_questions":{"items":{"$ref":"#/components/schemas/SuggestedQuestion"},"type":"array","title":"Suggested Questions"},"context_summary":{"type":"string","title":"Context Summary"},"generation_method":{"type":"string","title":"Generation Method"},"allow_custom_question":{"type":"boolean","title":"Allow Custom Question","default":true}},"type":"object","required":["suggested_questions","context_summary","generation_method"],"title":"SuggestQuestionsResponse","description":"Response from suggest-questions endpoint."},"SuggestedQuestion":{"properties":{"question":{"type":"string","title":"Question"},"category":{"type":"string","title":"Category"},"relevance_reason":{"type":"string","title":"Relevance Reason"},"priority":{"type":"integer","title":"Priority"}},"type":"object","required":["question","category","relevance_reason","priority"],"title":"SuggestedQuestion","description":"A suggested question."},"TaxOnCGTBracket-Input":{"properties":{"marginal_rate":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Marginal Rate"},"tax_amount":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Tax Amount"}},"type":"object","required":["marginal_rate","tax_amount"],"title":"TaxOnCGTBracket","description":"Tax on CGT at a specific marginal rate."},"TaxOnCGTBracket-Output":{"properties":{"marginal_rate":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Marginal Rate"},"tax_amount":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Tax Amount"}},"type":"object","required":["marginal_rate","tax_amount"],"title":"TaxOnCGTBracket","description":"Tax on CGT at a specific marginal rate."},"TaxOnCGTResponse-Input":{"properties":{"net_capital_gain":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Net Capital Gain"},"user_marginal_rate":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"User Marginal Rate"},"user_tax_amount":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"User Tax Amount"},"all_brackets":{"items":{"$ref":"#/components/schemas/TaxOnCGTBracket-Input"},"type":"array","title":"All Brackets"}},"type":"object","required":["net_capital_gain","all_brackets"],"title":"TaxOnCGTResponse","description":"Tax on CGT calculation result."},"TaxOnCGTResponse-Output":{"properties":{"net_capital_gain":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Net Capital Gain"},"user_marginal_rate":{"anyOf":[{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"User Marginal Rate"},"user_tax_amount":{"anyOf":[{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"},{"type":"null"}],"title":"User Tax Amount"},"all_brackets":{"items":{"$ref":"#/components/schemas/TaxOnCGTBracket-Output"},"type":"array","title":"All Brackets"}},"type":"object","required":["net_capital_gain","all_brackets"],"title":"TaxOnCGTResponse","description":"Tax on CGT calculation result."},"TimelineEvent":{"properties":{"date":{"type":"string","title":"Date"},"event":{"type":"string","title":"Event"},"details":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Details"}},"type":"object","required":["date","event"],"title":"TimelineEvent","description":"A single event in the property timeline."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"VerificationResponse":{"properties":{"gap_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Gap Id"},"property_address":{"type":"string","title":"Property Address"},"issue_period":{"$ref":"#/components/schemas/IssuePeriod"},"resolution_question":{"type":"string","title":"Resolution Question"},"user_response":{"type":"string","title":"User Response"}},"additionalProperties":true,"type":"object","required":["property_address","issue_period","resolution_question","user_response"],"title":"VerificationResponse"}}},"tags":[{"name":"CGT Analysis","description":"Core CGT calculation endpoints. Submit property data and get tax analysis."},{"name":"Follow-up Chat","description":"Conversational follow-up questions about CGT analysis results."},{"name":"Tax Agent Review","description":"Human-in-the-loop annotation system for tax agents to review and correct RAG outputs."},{"name":"Accuracy Dashboard","description":"Analytics on annotation data - accuracy by scenario, LLM, and failure patterns."},{"name":"Few-Shot Learning","description":"Auto-learning from human corrections. Manages the few-shot examples index."},{"name":"Training Data","description":"Export session data for fine-tuning LLMs."},{"name":"Utilities","description":"Helper endpoints for LLM providers and question suggestions."}]}